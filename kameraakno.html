<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
  <title>Kamera AR</title>

  <!-- A-Frame & AR.js -->
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-gesture-detector@4.0.5/dist/gesture-detector.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-super-hands-component@4.0.5/dist/aframe-super-hands.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/chenzlabs/aframe-ar-touch-controls/dist/aframe-ar-touch-controls.min.js"></script>
  <script src="https://github.com/lucide-icons/lucide/tree/main/packages/lucide"></script>
  <!-- Font & CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: 'Poppins', sans-serif;
      background-color: #000;
    }
    a-scene {
      position: absolute;
      top: 0; left: 0;
      z-index: 0;
    }
    .instruction-note, .exit-home-button, .manipulation-buttons, .model-description-box {
      animation: fadeIn 0.8s ease-out forwards;
      opacity: 0;
    }
 .instruction-note {
  position: absolute; top: 20px; right: 20px;
  background: rgba(0,0,0,0.6); color: white;
  padding: 6px 10px; border-radius: 8px;
  font-size: 0.8em; font-weight: 600;
  z-index: 1001;
  max-width: 180px;  /* ✅ agar wrap */
  text-align: left;  /* ✅ agar lebih rapi */
  word-wrap: break-word;
  line-height: 1.2;
  backdrop-filter: blur(5px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  transform: translateX(0);
}

    .exit-home-button {
      position: absolute; top: 20px; left: 20px;
      background: #393939; color: white;
      padding: 6px 12px; /* sebelumnya 12px 20px */
      font-size: 0.8em;   /* sebelumnya 1em */
      cursor: pointer; z-index: 1001;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      transform: translateX(-20px); border: none;
      border-radius: 20cap;
    }
    .exit-home-button:hover {
      background: #217DBB; transform: scale(1.03);
    }
    .manipulation-buttons {
      position: absolute; bottom: 20px; left: 20px;
      display: none; flex-direction: column; gap: 10px;
      z-index: 1001; transform: translateY(20px);
    }
    .manipulation-buttons button {
      background: rgba(46,204,113,0.8); color: white;
      padding: 12px 18px; border-radius: 8px;
      font-size: 0.95em; font-weight: 600;
      cursor: pointer; border: none;
      display: flex; align-items: center; gap: 8px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }
    .manipulation-buttons button:hover {
      background: #2ECC71; transform: translateY(-3px);
    }
    .audio-box {
      position: absolute; bottom: 20px; right: 20px;
      width: 90%; max-width: 340px; z-index: 1000;
      display: none; border-radius: 12px; overflow: hidden;
      box-shadow: 0 8px 20px rgba(0,0,0,0.5);
      animation: fadeIn 0.8s ease-out forwards;
      opacity: 0; background: rgba(0,0,0,0.6); padding: 10px;
    }
    .audio-box audio {
      width: 100%; margin-bottom: 8px;
      border-radius: 6px; background: white;
    }
/*     .model-description-box {
      position: absolute; top: 80px; left: 50%;
      transform: translateX(-50%);
      background: rgba(44,62,80,0.85); color: white;
      padding: 15px 25px; border-radius: 12px;
      font-size: 1em; text-align: center;
      max-width: 90%; z-index: 1002; display: none;
    }
    .model-description-box h3 {
      margin: 0 0 10px 0; font-size: 1.3em;
      font-weight: 700; color: #2ECC71;
    } */
.minimal-controls {
  position: absolute;
  top: 50%;
  right: 20px;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: 10px;
  z-index: 1001;
}


.minimal-controls button {
  background: rgba(255, 255, 255, 0.15);
  color: white;
  font-size: 1em;
  border: none;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  backdrop-filter: blur(4px);
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  cursor: pointer;
}

.minimal-controls button:hover {
  background: rgba(255,255,255,0.3);
}


.description-mini {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.5);
  color: white;
  padding: 6px 12px;
  font-size: 0.75em;
  border-radius: 10px;
  cursor: pointer;
  z-index: 1001;
  text-align: center;
}


.description-full {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  max-width: 90%;
  background: rgba(0,0,0,0.8);
  color: white;
  padding: 20px;
  font-size: 0.9em;
  border-radius: 10px;
  z-index: 2000;
}

    @keyframes fadeIn {
      to { opacity: 1; transform: translate(0,0); }
    }
    @media (max-width: 600px) {
  .instruction-note {
    font-size: 0.7em;
    max-width: 140px;
  }
}

  </style>
</head>
<body>

  <div class="instruction-note" id="instructionNote">Arahkan kamera HP pada marker AR</div>
  <button class="exit-home-button" onclick="exitToHome()"><i class="fas fa-home"></i> </button>

 <div class="manipulation-buttons" id="manipulationButtons">
    
  </div>
  <div class="model-description-box" id="modelDescriptionBox">
    <h3 id="modelDescriptionTitle"></h3>
    <p id="modelDescriptionContent"></p>
  </div>

  <a-scene embedded arjs vr-mode-ui="enabled: false" gesture-detector>
    <a-entity camera></a-entity>
  </a-scene>

  <script>
   const markers = [
{
    id: "marker1",
    audioBox: "audio-benda1",
    audioId: "aud-benda1-indo",
    modelId: "model-benda1",
    modelSrc: "asetakno/benda1.glb",
    markerUrl: "markerakno/marker1.patt",
    audioSrc: "audioaknoindo/1.mp3",
    initialScale: "2 2 2",
    descriptionTitle: "Lekeh",
    descriptionContent: "Fungsinya itu sebagai tempat untuk menaruh  panci atau wajan setelah memasak didapur,  lekeh ini terbuat dari bambu yang di ulat dan lekeh ini di gunakan pada jaman dahulu. Di buat pada tahun 2000 dari ; desa pedawa kec banjar kab buleleng."
 },
 {
    id: "marker2",
    audioBox: "audio-benda2",
    audioId: "aud-benda2-indo",
    modelId: "model-benda2",
    modelSrc: "asetakno/benda2.glb",
    audioSrc: "audioaknoindo/2.mp3",
    markerUrl: "markerakno/marker2.patt",
    initialScale: "2 2 2",
    descriptionTitle: "LABU",
    descriptionContent: "Fungsinya: Sebagai tempat air minum dan bisa juga digunakan untuk tempat tuak jaka pada zaman dulu dan sampai sekarang masih digunakan di desa pedalaman. Diserahkan pada tahun 2000, dari: Desa Pedawa, Kec. Banjar, Kab. Buleleng."
 },
 {
    id: "marker3",
    audioBox: "audio-benda3",
    audioId: "aud-benda3-indo",
    modelId: "model-benda3",
    modelSrc: "asetakno/benda3.glb",
    audioSrc: "audioaknoindo/3.mp3",
    markerUrl: "markerakno/marker3.patt",
    initialScale: "2 2 2",
    descriptionTitle: "BUMBUNG GARAM",
    descriptionContent: "Fungsinya: Sebagai tempat menaruh garam besar di dalamnya agar supaya tahan lama. Terbuat dari bambu dan digunakan pada zaman dahulu sampai sekarang di desa pedalaman. Diserahkan pada tahun 2000 dari: Desa Pedawa, Kec. Banjar, Kab. Buleleng."
 },
 {
    id: "marker4",
    audioBox: "audio-benda4",
    audioId: "aud-benda4-indo",
    modelId: "model-benda4",
    modelSrc: "asetakno/benda4.glb",
    audioSrc: "audioaknoindo/4.mp3",
    markerUrl: "markerakno/marker4.patt",
    initialScale: "2 2 2",
    descriptionTitle: "TEMPURUNG",
    descriptionContent: "Fungsinya: Sebagai tempat mencetak gula merah dan gula aren pada zaman dulu dan juga masih digunakan sampai sekarang di desa pedalaman. Dibuat dari kelapa dan kayu. Diserahkan pada tahun 2000 dari: Desa Pedawa, Kec. Banjar, Kab. Buleleng."
 },
 {
    id: "marker5",
    audioBox: "audio-benda5",
    audioId: "aud-benda5-indo",
    modelId: "model-benda5",
    modelSrc: "asetakno/benda5.glb",
    audioSrc: "audioaknoindo/5.mp3",
    markerUrl: "markerakno/marker5.patt",
    initialScale: "2 2 2",
    descriptionTitle: "BANGKIL",
    descriptionContent: "Fungsinya: Sebagai alat untuk pembersih rumput seperti tanaman padi gaga (padi gunung). Terbuat dari kayu dan besi, digunakan pada zaman dulu. Diserahkan pada tahun 2000 dari: Desa Pedawa, Kec. Banjar, Kab. Buleleng."
 },
 {
    id: "marker6",
    audioBox: "audio-benda6",
    audioId: "aud-benda6-indo",
    modelId: "model-benda6",
    modelSrc: "asetakno/benda6.glb",
    audioSrc: "audioaknoindo/6.mp3",
    markerUrl: "markerakno/marker6.patt",
    initialScale: "2 2 2",
    descriptionTitle: "BERUK",
    descriptionContent: "Fungsinya: Alat untuk pemujaan mohon pengobatan untuk bayi baru lahir dan juga bisa digunakan sebagai tempat air minum. Diserahkan pada tahun 2000 dari: Desa Pedawa, Kec. Banjar, Kab. Buleleng."
 },
 {
    id: "marker7",
    audioBox: "audio-benda7",
    audioId: "aud-benda7-indo",
    modelId: "model-benda7",
    modelSrc: "asetakno/benda7.glb",
    audioSrc: "audioaknoindo/7.mp3",
    markerUrl: "markerakno/marker7.patt",
    initialScale: "2 2 2",
    descriptionTitle: "TEMPAT SIRIH",
    descriptionContent: "Fungsinya: Untuk tempat sirih yang isinya daun sirih, buah pinang, dan kapur. Diserahkan pada tahun 2000 dari: Desa Pedawa, Kec. Banjar, Kab. Buleleng."
 },
 {
    id: "marker8",
    audioBox: "audio-benda8",
    audioId: "aud-benda8-indo",
    modelId: "model-benda8",
    modelSrc: "asetakno/benda8.glb",
    audioSrc: "audioaknoindo/8.mp3",
    markerUrl: "markerakno/marker8.patt",
    initialScale: "2 2 2",
    descriptionTitle: "PENGANCUR BASE/SIRIH",
    descriptionContent: "Fungsinya: Untuk menghancurkan daun base (sirih), buah pinang, dan kapur. Diserahkan pada tahun 2000 dari: Singaraja, Kec. Buleleng, Kab. Buleleng."
 },
 {
    id: "marker9",
    audioBox: "audio-benda9",
    audioId: "aud-benda9-indo",
    modelId: "model-benda9",
    modelSrc: "asetakno/benda9.glb",
    audioSrc: "audioaknoindo/9.mp3",
    markerUrl: "markerakno/marker9.patt",
    initialScale: "2 2 2",
    descriptionTitle: "PETAKA BALE PRABU AGUNG",
    descriptionContent: "Fungsinya: Untuk dudukan Sang Raja pada zaman dulu untuk joli. Diserahkan pada tahun 2000 dari: Desa Bungkuan, Kec. Kubutambahan, Kab. Buleleng."
 },
 {
    id: "marker10",
    audioBox: "audio-benda10",
    audioId: "aud-benda10-indo",
    modelId: "model-benda10",
    modelSrc: "asetakno/benda10.glb",
    audioSrc: "audioaknoindo/10.mp3",
    markerUrl: "markerakno/marker10.patt",
    initialScale: "2 2 2",
    descriptionTitle: "ANGGAPAN PADI",
    descriptionContent: "Fungsinya: Untuk memotong padi gaga, pada zaman dulu dan masih digunakan sampai sekarang di desa pedalaman. Diserahkan pada tahun 2000 dari: Kec. Sukasada, Kab. Buleleng."
 },
 {
    id: "marker11",
    audioBox: "audio-benda11",
    audioId: "aud-benda11-indo",
    modelId: "model-benda11",
    modelSrc: "asetakno/benda11.glb",
    audioSrc: "audioaknoindo/11.mp3",
    markerUrl: "markerakno/marker11.patt",
    initialScale: "2 2 2",
    descriptionTitle: "PIPA BESI",
    descriptionContent: "Fungsinya: Untuk saluran air Raja Buleleng yang dahulu pernah digunakan. Diserahkan pada tahun 2000 dari: Puri Gede Buleleng, Singaraja."
 },
 {
    id: "marker12",
    audioBox: "audio-benda12",
    audioId: "aud-benda12-indo",
    modelId: "model-benda12",
    modelSrc: "asetakno/benda12.glb",
    audioSrc: "audioaknoindo/12.mp3",
    markerUrl: "markerakno/marker12.patt",
    initialScale: "2 2 2",
    descriptionTitle: "GANDEK KECIL",
    descriptionContent: "Fungsinya: Sebagai tempat menaruh gente dan buku pada zaman dulu, dan masih digunakan sampai sekarang. Diserahkan pada tahun 2000 dari: Kab. Buleleng."
 },
 {
    id: "marker13",
    audioBox: "audio-benda13",
    audioId: "aud-benda13-indo",
    modelId: "model-benda13",
    modelSrc: "asetakno/benda13.glb",
    audioSrc: "audioaknoindo/13.mp3",
    markerUrl: "markerakno/marker13.patt",
    initialScale: "2 2 2",
    descriptionTitle: "GANDEK KAYU",
    descriptionContent: "Fungsinya: Tempat bekal seperti sirih, kapur, dan buah pinang pada zaman dulu, masih digunakan hingga sekarang. Diserahkan pada tahun 2000 dari: Kota Singaraja."
 },
 {
    id: "marker14",
    audioBox: "audio-benda14",
    audioId: "aud-benda14-indo",
    modelId: "model-benda14",
    modelSrc: "asetakno/benda14.glb",
    audioSrc: "audioaknoindo/14.mp3",
    markerUrl: "markerakno/marker14.patt",
    initialScale: "2 2 2",
    descriptionTitle: "SOK KASI",
    descriptionContent: "Fungsinya: Untuk membawa sesajen atau bekal makanan ke kebun pada zaman dulu. Diserahkan pada tahun 2000 dari: Desa Pedawa, Kec. Banjar, Kab. Buleleng."
 },
 {
    id: "marker15",
    audioBox: "audio-benda15",
    audioId: "aud-benda15-indo",
    modelId: "model-benda15",
    modelSrc: "asetakno/benda15.glb",
    audioSrc: "audioaknoindo/15.mp3",
    markerUrl: "markerakno/marker15.patt",
    initialScale: "2 2 2",
    descriptionTitle: "TEMPEH / NIRU KECIL",
    descriptionContent: "Fungsinya: Alat pemujaan untuk mohon pengobatan bayi sakit seperti boreh. Masih digunakan sampai sekarang. Diserahkan pada tahun 2000 dari: Desa Tigawasa, Kec. Banjar, Kab. Buleleng."
 }
];


    const scene = document.querySelector('a-scene');
    const manipulationButtons = document.getElementById('manipulationButtons');
    const instructionNote = document.getElementById('instructionNote');
    const modelDescriptionBox = document.getElementById('modelDescriptionBox');
    const modelDescriptionTitle = document.getElementById('modelDescriptionTitle');
    const modelDescriptionContent = document.getElementById('modelDescriptionContent');
    let activeModel = null;

    function hideAllAudio() {
      markers.forEach(({ audioBox, audioId }) => {
        const box = document.getElementById(audioBox);
        const audio = document.getElementById(audioId);
        if (box) box.style.display = 'none';
        if (audio) { audio.pause(); audio.currentTime = 0; }
      });
    }

    function showManipulationButtons() {
      manipulationButtons.style.display = 'flex';
      manipulationButtons.style.animation = 'fadeIn 0.8s ease-out forwards';
    }

    function hideManipulationButtons() {
      manipulationButtons.style.display = 'none';
      manipulationButtons.style.opacity = 0;
    }

    function showModelDescription(title, content) {
      modelDescriptionTitle.textContent = title;
      modelDescriptionContent.textContent = content;
      modelDescriptionBox.style.display = 'block';
    }

    function hideModelDescription() {
      modelDescriptionBox.style.display = 'none';
      modelDescriptionBox.style.opacity = 0;
    }

    function rotateModel(axis, angle) {
      if (activeModel) {
        let rot = activeModel.getAttribute('rotation') || { x: 0, y: 0, z: 0 };
        if (axis === 'X') rot.x += angle;
        if (axis === 'Y') rot.y += angle;
        if (axis === 'Z') rot.z += angle;
        activeModel.setAttribute('rotation', rot);
      }
    }

    function scaleModel(factor) {
      if (activeModel) {
        let scale = activeModel.getAttribute('scale');
        let parts = typeof scale === 'string' ? scale.split(' ').map(parseFloat) : [scale.x, scale.y, scale.z];
        let newScale = parts.map(s => Math.min(5, Math.max(0.01, s * factor)));
        activeModel.setAttribute('scale', newScale.join(' '));
      }
    }

    function resetModel() {
      if (activeModel) {
        const data = markers.find(m => m.modelId === activeModel.id);
        activeModel.setAttribute('position', '0 0 0');
        activeModel.setAttribute('rotation', '0 0 0');
        activeModel.setAttribute('scale', data.initialScale);
      }
    }

    function exitToHome() {
      window.location.href = 'index.html';
    }

    document.addEventListener('DOMContentLoaded', () => {
      instructionNote.style.animationDelay = '0.5s';
      instructionNote.style.animation = 'fadeIn 0.8s ease-out forwards';
      document.querySelector('.exit-home-button').style.animationDelay = '0.7s';
      document.querySelector('.exit-home-button').style.animation = 'fadeIn 0.8s ease-out forwards';

      // Generate dynamic elements
      markers.forEach(data => {
        // Marker and Model
        const marker = document.createElement('a-marker');
        marker.setAttribute('id', data.id);
        marker.setAttribute('type', 'pattern');
        marker.setAttribute('url', data.markerUrl);
        
        const model = document.createElement('a-entity');
        model.setAttribute('id', data.modelId);
        model.setAttribute('gltf-model', data.modelSrc);
        model.setAttribute('scale', data.initialScale);
        model.setAttribute('position', '0 0 0');
        model.setAttribute('ar-touch-controls', 'rotation: true; scale: true');
        marker.appendChild(model);
        scene.appendChild(marker);

        // Audio Box
        const audioBox = document.createElement('div');
        audioBox.setAttribute('id', data.audioBox);
        audioBox.className = 'audio-box';

        const audio = document.createElement('audio');
        audio.setAttribute('id', data.audioId);
        audio.setAttribute('src', data.audioSrc);
        audio.setAttribute('controls', true);
        audioBox.appendChild(audio);
        document.body.appendChild(audioBox);

        // Event
        marker.addEventListener('markerFound', () => {
          hideAllAudio();
          audioBox.style.display = 'block';
          if (audio) {
            audio.currentTime = 0;
            audio.play();
          }
          activeModel = model;
          showManipulationButtons();
          showModelDescription(data.descriptionTitle, data.descriptionContent);
        });

        marker.addEventListener('markerLost', () => {
          if (audio) {
            audio.pause();
            audio.currentTime = 0;
          }
          audioBox.style.display = 'none';
          activeModel = null;
          hideManipulationButtons();
          hideModelDescription();
        });
      });
    });
    function toggleDescription() {
  const mini = document.getElementById('descMini');
  const full = document.getElementById('descFull');
  if (full.style.display === 'block') {
    full.style.display = 'none';
    mini.style.display = 'block';
  } else {
    full.style.display = 'block';
    mini.style.display = 'none';
  }
}

function showModelDescription(title, content) {
  document.getElementById('descMini').style.display = 'block';
  document.getElementById('descFull').style.display = 'none';
  document.getElementById('descTitle').innerText = title;
  document.getElementById('descText').innerText = content;
}
function rotateModel(axis, angle) {
  if (!activeModel) {
    console.warn("activeModel belum tersedia!");
    return;
  }
  let rot = activeModel.getAttribute('rotation') || { x: 0, y: 0, z: 0 };
  if (axis === 'X') rot.x += angle;
  if (axis === 'Y') rot.y += angle;
  if (axis === 'Z') rot.z += angle;
  activeModel.setAttribute('rotation', rot);
}

  </script>
  <!-- Minimal Control Buttons -->
<!-- Tombol Kontrol Minimalis di Tengah Bawah -->
<div class="minimal-controls">
  <button onclick="rotateModel('X', -10)" class="btn-control" title="Rotate X -">
    <i data-lucide="arrow-up"></i>
  </button>
  <button onclick="rotateModel('Y', -10)" class="btn-control" title="Rotate Y -">
    <i data-lucide="rotate-ccw"></i>
  </button>
  <button onclick="rotateModel('Z', -10)" class="btn-control" title="Rotate Z -">
    <i data-lucide="undo-2"></i>
  </button>
  <button onclick="rotateModel('X', 10)" class="btn-control" title="Rotate X +">
    <i data-lucide="arrow-down"></i>
  </button>
  <button onclick="rotateModel('Y', 10)" class="btn-control" title="Rotate Y +">
    <i data-lucide="rotate-cw"></i>
  </button>
  <button onclick="rotateModel('Z', 10)" class="btn-control" title="Rotate Z +">
    <i data-lucide="redo-2"></i>
  </button>
  <button onclick="scaleModel(1.1)" class="btn-control" title="Zoom In">
    <i data-lucide="zoom-in"></i>
  </button>
  <button onclick="resetModel()" class="btn-control" title="Reset">
    <i data-lucide="refresh-ccw"></i>
  </button>
  <button onclick="scaleModel(0.9)" class="btn-control" title="Zoom Out">
    <i data-lucide="zoom-out"></i>
  </button>
</div>



<!-- Mini Description -->
<div class="description-mini" id="descMini" onclick="toggleDescription()">
  Klik untuk info benda
</div>

<!-- Full Description -->
<div class="description-full" id="descFull" onclick="toggleDescription()">
  <h3 id="descTitle"></h3>
  <p id="descText"></p>
</div>

</body>


<script src="https://unpkg.com/lucide@latest"></script>
<script>
  lucide.createIcons();
</script>

</html>